<html lang="UTF-8">
<head>
  <meta charset="UTF-8">
  <!--<script src="https://fb.me/react-0.14.0.js"> </script>
	<script src="https://fb.me/react-dom-0.14.0.js"> </script>
  16.3 부터 context를 지원한다.
  https://reactjs.org/versions/
  -->
  <script src="https://unpkg.com/react@16.8.6/umd/react.development.js" crossorigin></script>
  <script src="https://unpkg.com/react-dom@16.8.6/umd/react-dom.development.js" crossorigin></script>
	<script src="https://fb.me/JSXTransformer-0.13.3.js"> </script>
  <title>Document</title>
</head>
<body>
  <div id="ex1"></div>
  <div id="ex2"></div>
  <script>
      import React, { Component, useContext } from 'react';
  </script>
  <script type="text/jsx">

    //Context
    //Context를 사용하면 props으로 일일이 넘겨주지 않아도 트리 전체에서
    //데이터 사용 가능
    // React 컴포넌트 트리안에서 전역적으로 데이터를
    //공유 할 수 있도록 고안된 방법

    class App extends React.Component {
      render() {
        return <Toolbar theme="dark" />;
      }
    }

    function Toolbar(props) {
      // Toolbar 컴포넌트는 불필요한 테마 prop를 받아서
      // ThemeButton에 전달해야 합니다.
      // 앱 안의 모든 버튼이 테마를 알아야 한다면
      // 이 정보를 일일이 넘기는 과정은 매우 곤혹스러울 수 있습니다.
      return (
        <div>
          <ThemedButton theme={props.theme} />
        </div>
      );
    }

    class ThemedButton extends React.Component {
      render() {
        return <button theme={this.props.theme} />;
      }
    }

    ReactDOM.render(
      <App/>,
      document.getElementById('ex1')
    );

    //context를 사용하면 중간에 있는 element에게 props를
    //넘겨주지 않아도 됨

    // context를 사용하면 모든 컴포넌트를 일일이 통하지 않고도
    // 원하는 값을 컴포넌트 트리 깊숙한 곳까지 보낼 수 있습니다.
    // light를 기본값으로 하는 테마 context를 만들어 봅시다.

    const ThemeContext = React.createContext('light');
    class ThemeApp extends React.Component{

      render(){
        // Provider를 이용해 하위 트리에 테마 값을 보내줍니다.
       // 아무리 깊숙히 있어도, 모든 컴포넌트가 이 값을 읽을 수 있습니다.
       // 아래 예시에서는 dark를 현재 선택된 테마 값으로 보내고 있습니다.

       return(
         <ThemeContext.Provider value ="dark">
           <ThemeToolbar />
         </ThemeContext.Provider>
       );
      }
    }
    // 이젠 중간에 있는 컴포넌트가 일일이 테마를 넘겨줄 필요가 없습니다.
    function ThemeToolbar(props) {
      return (
        <div>
          <ThemedButton2 />
        </div>
      );
    }
    class ThemedButton2 extends React.Component {
      // 현재 선택된 테마 값을 읽기 위해 contextType을 지정합니다.
      // React는 가장 가까이 있는 테마 Provider를 찾아 그 값을 사용할 것입니다.
      // 이 예시에서 현재 선택된 테마는 dark입니다.
      //static contextType = ThemeContext;
      render() {
        return <button value={this.context} />;
      }
    }
    ReactDOM.render(
      <ThemeApp/>,
      document.getElementById('ex2')
    );

    </script>
</body>
</html>
